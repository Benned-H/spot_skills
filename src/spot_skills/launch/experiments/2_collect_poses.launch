<!-- Phase 2: Collect object pose estimates and landmarks relative to the saved map -->
<launch>

    <!-- For safety reasons, do not assume which Spot is being used -->
    <arg name="spot_name" />
    <arg name="real_robot" value="true" />

    <!-- Allow the user to specify the path to their recorded point cloud map -->
    <arg name="rtabmap_database_path" default="/docker/spot_skills/maps/rtabmap.db" />

    <!-- Launch nodes for AR tag tracking using ar_track_alvar -->
    <include file="$(find spot_skills)/launch/bringup_alvar.launch">
        <arg name="apriltags_yaml_path" value="/docker/spot_skills/src/spot_skills/config/experiments/erase_board/apriltags.yaml" />
        <arg name="yaml_output_path" value="/docker/spot_skills/src/spot_skills/config/experiments/erase_board/output-poses.yaml" />

        <arg name="enable_frontleft_single_large" value="true" />
        <arg name="enable_frontright_single_large" value="true" />
    </include>

    <!-- Launch all nodes to control Spot using MoveIt (this loads the robot description) -->
    <include file="$(find spot_skills)/launch/spot_moveit_bringup.launch">
        <arg name="real_robot" value="$(arg real_robot)" />
        <arg name="spot_name" value="$(arg spot_name)" />
    </include>

    <!-- Launch the main launch file from spot_rtabmap in localization mode -->
    <include file="$(find spot_rtabmap)/launch/spot_rtabmap.launch">
        <arg name="localization_mode" value="true" />
        <arg name="start_new_map" value="false" />
        <arg name="rtabmap_database_path" value="$(arg rtabmap_database_path)" />
    </include>

    <!-- Launch the navigation system using its bringup file -->
    <include file="$(find spot_skills)/launch/bringup_spot_nav.launch" />

    <!-- Launch RViz with the config for SLAM -->
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find spot_skills)/rviz/spot_nav_demo.rviz" />

</launch>
